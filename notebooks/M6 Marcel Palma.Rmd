


---
title: "An√°lisis de Datos de F√∫tbol ‚Äî Caso Pr√°ctico"
author: "Marcel Andr√©s Palma C√©spedes"
date: "`r format(Sys.Date(), '%d %B %Y')`"
output:
  html_document:
    toc: true
    toc_depth: '2'
    df_print: paged
  html_notebook:
    toc: true
    toc_depth: 2
    number_sections: false
    theme: cosmo
  word_document:
    toc: true
    toc_depth: '2'
  pdf_document:
    toc: true
    toc_depth: '2'
---

<div style="background:#0b3d91;color:white;padding:18px;border-radius:8px;margin-bottom:12px;">
  <h1 style="margin:0;padding:0;">üìä An√°lisis de Datos de F√∫tbol ‚Äî Caso Pr√°ctico</h1>
  <p style="margin:0.2rem 0 0 0;">IMMUNE Technology Institute ‚Äî Informe interactivo (R Notebook)</p>
</div>


# Introducci√≥n  

Este proyecto busca realizar un an√°lisis exploratorio y predictivo de los datos 
de rendimiento de jugadores de f√∫tbol, utilizando **R** como herramienta principal.  

**Objetivos principales:**
- Analizar patrones en variables de rendimiento (goles, minutos, posiciones, etc.).
- Construir un modelo de regresi√≥n para predecir una variable objetivo.
- Evaluar el modelo con m√©tricas estad√≠sticas (RMSE, R¬≤).
- Aplicar ANOVA y comparaciones m√∫ltiples (Tukey) para contrastar grupos.


# üìä Paso 1 (C√≥digo): instalar y cargar librer√≠as + configurar opciones
```{r setup, message=FALSE, warning=FALSE}
# Paso 1: instalar y cargar librer√≠as + configurar opciones

# Instalar paquetes si no existen (ejecuta s√≥lo la primera vez)
required_pkgs <- c(
  "tidyverse", "readxl", "janitor", "skimr", "GGally",
  "caret", "broom", "generics", "vctrs", "dplyr", "AER", "car","pscl", "ggplot2", "data.table", "patchwork", "multcomp", "kableExtra"
)

new_pkgs <- required_pkgs[!(required_pkgs %in% installed.packages()[, "Package"])]
if (length(new_pkgs) > 0) install.packages(new_pkgs)

# Cargar librer√≠as
suppressPackageStartupMessages({
  library(knitr)
  library(pscl)
  library(generics)
  library(AER)
  library(kableExtra)
  library(tidyverse)
  library(readxl)
  library(vctrs)
  library(dplyr)
  library(janitor)
  library(skimr)
  library(GGally)
  library(caret)
  library(broom)
  library(car)
  library(patchwork)
  library(multcomp)
  library(data.table)
})

# Opciones est√©ticas y reproducibilidad
options(stringsAsFactors = FALSE)
set.seed(123)
theme_set(theme_minimal())
```

## üß© Comprobaci√≥n de librer√≠as
```{r}
# Verifica que los paquetes se cargan sin error
library(tidyverse)
library(readxl)
library(janitor)
library(skimr)
library(GGally)
library(caret)
library(broom)
library(car)
library(patchwork)
library(multcomp)
library(data.table)
```

# ü™∂ Paso 2: Cargar y explorar la base de datos
```{r}
ruta <- "C:/Users/Marcel Palma/Desktop/IMMUNE/6. Asignatura 6  Estad√≠stica para cient√≠ficos de datos Programaci√≥n en R/Case to be solved/df_futbol.xlsx"

# Leer el archivo Excel y limpiar nombres de columnas
df <- read_excel(ruta) %>%
  clean_names()
```


```{r}
# Mostrar las primeras filas del dataset
head(df)

# Ver el n√∫mero de filas y columnas
dim(df)

# Ver los nombres de las columnas
names(df)
```

# ü™∂ Paso 3 ‚Äî Limpieza y preparaci√≥n inicial de datos

En esta etapa se revisa la calidad de los datos y se crean variables derivadas
que servir√°n para el an√°lisis exploratorio y la modelizaci√≥n.
Se examinan los valores faltantes, duplicados y se generan nuevas variables
como la raz√≥n de goles por 90 minutos de juego.

```{r limpieza_datos}
# Paso 3: Limpieza y preparaci√≥n inicial de datos

# 1. Revisar valores faltantes (NA)
colSums(is.na(df))

# 2. Verificar si existen filas duplicadas
duplicados <- df[duplicated(df), ]
nrow(duplicados)

# 3. Crear variables derivadas √∫tiles para el an√°lisis
#    (solo si las columnas necesarias existen y no tienen NA cr√≠ticos)

df <- df %>%
  mutate(
    # Goles por 90 minutos jugados
    goles_por_90 = if_else(min > 0, (goles / min) * 90, NA_real_),

    # Asistencias por 90 minutos jugados
    asistencias_por_90 = if_else(min > 0, (asistencias / min) * 90, NA_real_),

    # Porcentaje de partidos jugados como titular
    pct_titular = if_else(partidos_jugados > 0, (titular / partidos_jugados) * 100, NA_real_)
  )

# 4. Verificar que las nuevas columnas se hayan creado correctamente
glimpse(df)
```

## üß© Correcci√≥n en dataset desde el archivo de excel
Algunos casos como Joan Oblak, portero del Atl√©tico de Madrid ha jugado 38 partidos y ha sido titular en todos, pero la celda indica 3,42 minutos lo cual es imposible. Se debe interpretar como 3240 (90 * 38 jugados son 3240 √≥ tres mil doscientos cuarenta minutos). En el caso de H√©ctor Herrera jug√≥ 16 partidos y ha sido titular s√≥lo en 8, muestra 682 minutos, ah√≠ si est√° correcto pues 8 * 90 es 720 minutos muy similar a 682 y seguramente no jug√≥ todo el partido. Conclusi√≥n: multiplicar por mil los que tienen comas y los que no dejarlos tal cual, pero se prefiere cambiarlo directamente del data set en excel.


## üß© Verificaci√≥n r√°pida (solo para comprobar)
```{r}
summary(df$min)
summary(df$goles_por_90)
summary(df$asistencias_por_90)
```

# üöÄ Paso 4: An√°lisis Exploratorio (EDA)
Gr√°ficos y resumen con ggplot2 y GGall (informe estilo html)

```{r paso4_eda}

# Distribuci√≥n de minutos jugados
ggplot(df, aes(x = min)) +
  geom_histogram(bins = 20, fill = "#2E86AB", color = "white", alpha = 0.8) +
  labs(title = "Distribuci√≥n de minutos jugados", x = "Minutos", y = "Frecuencia")

# Distribuci√≥n de goles y asistencias
p1 <- ggplot(df, aes(x = goles)) +
  geom_histogram(bins = 20, fill = "#2ECC71", color = "white") +
  labs(title = "Distribuci√≥n de goles", x = "Goles")

p2 <- ggplot(df, aes(x = asistencias)) +
  geom_histogram(bins = 20, fill = "#F39C12", color = "white") +
  labs(title = "Distribuci√≥n de asistencias", x = "Asistencias")

# Mostrar ambos histogramas juntos
p1 + p2

# Boxplot comparando goles por posici√≥n
ggplot(df, aes(x = posicion, y = goles, fill = posicion)) +
  geom_boxplot(alpha = 0.7) +
  labs(title = "Distribuci√≥n de goles seg√∫n posici√≥n", x = "Posici√≥n", y = "Goles") +
  theme(legend.position = "none")

# Correlaci√≥n entre variables num√©ricas (usando dplyr::select para evitar conflictos)
df %>%
  dplyr::select(edad, min, goles, asistencias, goles_por_90, asistencias_por_90) %>%
  GGally::ggpairs(title = "Matriz de correlaci√≥n entre variables clave")
```

## üìä Interpretaci√≥n del primer gr√°fico de histograma:(Minutos jugados) 
### DISTRIBUCI√ìN DE MINUTOS JUGADOS
- Distribuci√≥n asim√©trica con sesgo positivo
- Pico principal de alta frecuencia alrededor de los 0-500 minutos
- Cola larga extenida hasta los 3000 minutos
- Jugadores con pocos minutos, concentrados en el extremo izquierdo. Muchos con participaci√≥n limitada
- Jugadores titulares con obvia frecuencia m√°s baja y constante entre 1500 y 3000 minutos
- Brecha notable por disminuci√≥n abrupta despu√©s del pico inicial, refleja clara divisi√≥n entre suplentes y titulares
- Polarizaci√≥n en el uso de jugadores
- Muchos de estos tienen roles secundarios o de rotaci√≥n
- Pocos alcanzan los 3000 minutos (equivalente a ‚âà33 a 35 partidos completos)


## üìä Interpretaci√≥n del segundo gr√°fico de histogramas: (Goles vs Asistencias)
### DISTRIBUCI√ìN DE GOLES
- Distribuci√≥n exponencial/poisson t√≠pica del f√∫tbol
- Pico de ‚âà300 jugadores que anotan de 0 a 2 goles
- Cola larga, pocos jugadores con m√°s de 10 goles.
- Algunos alcanzan un m√°ximo de 25 a 30 goles
- La mayor parte anota poco (Entre un 75 y 80% de jugadores tiene ‚â§5 goles)
- Goleadores escasos, pocos superan los 15 goles
- Distribuci√≥n esperada que Coincide con la realidad del f√∫tbol, en el cual es com√∫n que pocos anoten muchos goles
### DISTRIBUCI√ìN DE ASISTENCIAS (Gr√°fico derecho)
- Similar al de goles pero m√°s concentrado
- Pico m√°s pronunciado en ‚âà300 jugadores con 0 a 1 asistencias
- El rango m√°s limitado es de m√°ximo ‚âà10 a 12 asistencias
- Mayor concentraci√≥n en valores bajos
- Asistentes regulares, pocos superan 5 asistencias
- En comparaci√≥n con goles las asistencias son m√°s dif√≠ciles de conseguir
- El f√∫tbol es un deporte de pocos anotadores
- La productividad ofensiva se concentra en un peque√±o grupo
- Patr√≥n t√≠pico de la liga espa√±ola es que pocos jugadores dominan las estad√≠sticas ofensivas


## üìä  Interpretaci√≥n del tercer gr√°fico boxplot: (Goles por Posici√≥n)
### DISTRIBUCI√ìN DE GOLES SEG√öN POSICI√ìN
#### Claves de nomenclatura:
- CC: Delanteros/Center Forward
- DF: Defensas
- DL: Mediocampistas
- PO: Porteros
#### Combinaciones: 
- Posiciones h√≠bridas (ej: CC_DF = Delantero con funciones defensivas)

### AN√ÅLISIS POR POSICI√ìN:
üèÜ M√ÅXIMOS GOLEADORES:

  - CC (Delanteros puros): Mayor mediana y rango intercuart√≠lico
  - DL_CC (Mediocampistas ofensivos): Segundos en productividad
  - CC_DL (Delanteros con perfil de mediocampista): Buen rendimiento goleador
  
‚ö° POSICIONES H√çBRIDAS INTERESANTES:

  - CC_DF: Sorprendente buen rendimiento (delanteros defensivos)
  - DL_CC vs CC_DL: Diferencia notable a favor de los que tienen CC como posici√≥n principal
  
üõ°Ô∏è POSICIONES DEFENSIVAS:

  - DF (Defensas puros): Muy baja productividad goleadora
  - DF_CC, DF_DL: Ligeramente mejor pero a√∫n baja
  - PO (Porteros): Casi nula contribuci√≥n goleadora por obvias razones
  
üß© OBSERVACIONES:

- Variabilidad en CC: Amplio rango entre el percentil 25 y 75 en delanteros
- Outliers destacables en algunos defensas (DF) y mediocampistas (DL) con rendimiento excepcional
- Efectividad de especializaci√≥n en CC puro, supera a todas las combinaciones h√≠bridas
- Delanteros tradicionales siguen siendo los m√°ximos goleadores
- Posiciones h√≠bridas ofensivas tienen buen rendimiento
- Clara especializaci√≥n ofensiva vs defensiva.



## üìä Interpretaci√≥n de la Matriz de Correlaci√≥n
La matriz muestra la relaci√≥n entre seis variables clave: **edad**, **min** (minutos jugados), **goles** (totales), **asistencias**, **goles_por_90** (goles por 90 minutos) y **asistencias_por_90** (asistencias por 90 minutos).  

---

### A. Correlaciones de Rendimiento Total (Goles y Asistencias)

| Variables | Correlaci√≥n (r) | Significado |
|------------|-----------------|--------------|
| **Goles vs Asistencias** | 0.531*** | üîπ Fuerte correlaci√≥n positiva. Los jugadores que marcan muchos goles tambi√©n tienden a dar muchas asistencias, lo que sugiere una productividad ofensiva integral. |
| **Minutos vs Goles** | 0.395*** | üîπ Correlaci√≥n positiva moderada. Cuantos m√°s minutos juega un jugador, m√°s oportunidades tiene de marcar. |
| **Minutos vs Asistencias** | 0.435*** | üîπ Correlaci√≥n positiva moderada-fuerte. El tiempo en cancha influye incluso m√°s en la acumulaci√≥n de asistencias que de goles. |

> üí° *Los asteriscos (***) indican significancia estad√≠stica (p < 0.001).*


üèÜ En las correlaciones de rendimiento total se confirma que el rendimiento ofensivo es integral y est√° impulsado por la participaci√≥n.
- Productividad ofensiva unificada (r=0.531): Los jugadores que marcan muchos goles tambi√©n son los que m√°s asisten. Sugiere que la habilidad ofensiva es una cualidad completa, no se limita s√≥lo a finalizar o crear el juego.
- Importancia del tiempo de juego: Correlaci√≥n moderada - fuerte entre minutos y estad√≠sticas totales de goles (r=0.395) y asistencias (r=0.435). 
- Para acumular grandes n√∫meros la condici√≥n b√°sica es ser jugador titular habitual.

---

### B. Correlaciones de Eficiencia (Por cada 90 minutos)

Estas variables miden la **eficiencia**, independientemente de cu√°ntos minutos haya jugado el jugador.

| Variables | Correlaci√≥n (r) | Significado |
|------------|-----------------|--------------|
| **Goles vs Goles_por_90** | 0.719*** | üîπ Correlaci√≥n muy fuerte. Los jugadores con m√°s goles totales tambi√©n son m√°s eficientes. |
| **Asistencias vs Asistencias_por_90** | 0.447*** | üîπ Correlaci√≥n moderada-fuerte. Los que m√°s asisten suelen tener buena tasa por minuto, pero con m√°s variabilidad. |
| **Goles_por_90 vs Asistencias_por_90** | 0.308*** | üîπ Correlaci√≥n baja-moderada. Los jugadores m√°s eficientes al marcar tambi√©n suelen asistir m√°s, aunque hay cierta especializaci√≥n. |

‚ö°En la correlaci√≥n de la eficiencia (por cada 90 Minutos). Esta tabla analiza la calidad del rendimiento sin importar el tiempo jugado.
- El goleador es eficiente (r=0.719): La correlaci√≥n m√°s alta de toda la matriz es entre Goles (totales) y Goles_por_90. Los jugadores que logran marcar muchos goles tienen tasas de eficiencia goleadora muy altas, e indica que el volumen es un reflejo directo de la calidad de finalizaci√≥n.
- Especializaci√≥n: La correlaci√≥n entre Goles_por_90 y Asistencias_por_90 es la m√°s baja de todas (r=0.308). Sugiere que a nivel de eficiencia hay mayor especializaci√≥n. Un jugador puede ser muy eficiente marcando pero no asistiendo y viceversa.

---

### üßì C. Correlaciones con la Edad

| Variables | Correlaci√≥n (r) | Significado |
|------------|-----------------|--------------|
| **Edad vs Minutos** | 0.311*** | üîπ Correlaci√≥n baja-moderada. Los jugadores m√°s veteranos tienden a jugar m√°s minutos, posiblemente por confianza o experiencia. |
| **Edad vs Goles** | 0.137*** | üîπ Relaci√≥n positiva d√©bil. |
| **Edad vs Asistencias** | 0.141*** | üîπ Relaci√≥n positiva d√©bil. |
| **Edad vs Goles_por_90** | 0.077 | üî∏ Correlaci√≥n casi nula. |
| **Edad vs Asistencias_por_90** | ‚àí0.012 | üî∏ Correlaci√≥n nula o irrelevante. |

> üß† **Conclusi√≥n sobre la Edad:** La edad no tiene un efecto claro sobre la eficiencia; aunque los jugadores mayores juegan m√°s minutos, su rendimiento por 90 minutos es similar al de los j√≥venes.

üßì Correlaciones con Edad: Se eval√∫a el impacto de la experiencia en el rendimiento.
- La Experiencia da minutos: Correlaci√≥n positiva d√©bil con Minutos (r=0.311). Los jugadores m√°s experimentados dentro del rango de la liga tienden a ser los que m√°s minutos de juego acumulan (son la base del equipo).
- La Edad no define eficiencia: Correlaciones con las m√©tricas por_90 (Goles_por_90:r=0.077; Asistencias_por_90: r=-0.012) son pr√°cticamente nulas. La efectividad y la calidad del rendimiento de un jugador en la liga espa√±ola (seg√∫n tasa por 90 minutos) no dependen de la edad. Los j√≥venes talentos pueden ser tan eficientes como los veteranos consolidados.

---

### üéØ Conclusi√≥n General del Gr√°fico

- ‚öΩ **Productividad  ofensiva integral:** La correlaci√≥n entre goles y asistencias (r = 0.531***) es la m√°s alta entre los totales, mostrando que el talento ofensivo suele ser completo.  
- ‚è±Ô∏è **La cantidad impulsa al total:** Las correlaciones moderadas con los minutos confirman que el volumen de juego determina la acumulaci√≥n de goles y asistencias.  
- üë¥ **La edad no es un factor de eficiencia:** Aunque la experiencia influye en el tiempo jugado, la productividad por 90 minutos no depende significativamente de la edad.

---

üí¨ *En resumen:* 
- El rendimiento total est√° impulsado por la participaci√≥n en cancha
- La eficiencia es una cualidad m√°s individual y estable, independiente de la edad. 
- La participaci√≥n ofensiva es un rasgo completo (goles y asistencias de la mano).
- El rendimiento ofensivo altamente polarizado (pocos jugadores acumulan grandes n√∫meros).
- La edad est√° m√°s relacionada con ser titular y acumular minutos que con la eficiencia del rendimiento en el campo.




# ‚öôÔ∏è PASO 5 ‚Äì Modelado de Regresi√≥n M√∫ltiple
## üß© 1Ô∏è‚É£ Definir el objetivo y preparar los datos
```{r paso5_preparar_datos}
# Objetivo: Predecir los goles de un jugador en funci√≥n de sus caracter√≠sticas. Analizar la cantidad de goles en funci√≥n de las variables relevantes del jugador (edad, minutos jugados, asistencias y posici√≥n).

# Seleccionamos las variables m√°s relevantes
modelo_df <- df %>%
  dplyr::select(goles, edad, min, asistencias, posicion) %>%
  mutate(posicion = as.factor(posicion))  # Convertimos posici√≥n a variable categ√≥rica

# Verificar estructura
glimpse(modelo_df)
```
üí° Se escoge la variable dependiente (goles)
üí° Independientes: edad, minutos, asistencias y posici√≥n
üí° Se convierte posici√≥n en factor (porque es categ√≥rica)

## ‚úÇÔ∏è 2Ô∏è‚É£ Dividir en conjuntos de entrenamiento y prueba (Train & Test)
Con "caret" dividir datos (80 % entrenamiento y 20 % prueba):
```{r paso5_dividir_datos}
set.seed(123)  # Reproducibilidad

# Dividir datos en train (80%) y test (20%)
indice <- createDataPartition(modelo_df$goles, p = 0.8, list = FALSE)
train_data <- modelo_df[indice, ]
test_data  <- modelo_df[-indice, ]

# Revisar dimensiones
dim(train_data)
dim(test_data)
```
Se asegura que el modelo se entrene y eval√∫e con datos distintos y evitar el sobreajuste.

##  üìä 3Ô∏è‚É£ Entrenar el modelo de regresi√≥n m√∫ltiple
Ajuste del modelo lineal (lm) con variables predictoras:
```{r paso5_entrenar_modelo}
# Entrenamos un modelo de regresi√≥n lineal m√∫ltiple
modelo_goles <- lm(goles ~ edad + min + asistencias + posicion, data = train_data)

# Resumen del modelo
summary(modelo_goles)
```
‚öôÔ∏è Estructura del modelo
goles = Œ≤‚ÇÄ + Œ≤‚ÇÅ(edad) + Œ≤‚ÇÇ(min) + Œ≤‚ÇÉ(asistencias) + Œ≤‚ÇÑ(posici√≥n) + Œµ

## üìä 4Ô∏è‚É£ Evaluar el rendimiento del modelo
Calcular predicciones y m√©tricas de error:
```{r paso5_evaluar_modelo}
# Predecimos con el modelo
predicciones <- predict(modelo_goles, newdata = test_data)

# Calcular m√©tricas de desempe√±o
rmse_val <- RMSE(predicciones, test_data$goles)
r2_val <- R2(predicciones, test_data$goles)

# Mostrar resultados
cat("üìè Error Cuadr√°tico Medio (RMSE):", round(rmse_val, 3), "\n")
cat("üìà R-cuadrado (R¬≤):", round(r2_val, 3), "\n")
```

üß© Tabla 1 ‚Äî M√©tricas Generales del Modelo

```{r tabla_metrica_general, results='asis'}
library(knitr)
library(kableExtra)

metricas_general <- data.frame(
  Indicador = c(
    "R-cuadrado (R¬≤)",
    "R-cuadrado ajustado",
    "F-statistic",
    "Error est√°ndar residual"
  ),
  Valor = c("0.4861", "0.4725", "35.79 (p < 0.001)", "2.335"),
  Interpretaci√≥n = c(
    "El modelo explica el 48.6% de la variabilidad total en los goles.",
    "Tras ajustar por n√∫mero de predictores, mantiene un buen poder explicativo.",
    "El modelo completo es altamente significativo; al menos una variable influye en los goles.",
    "El modelo se equivoca en promedio unos 2.3 goles por jugador, valor razonable dado el rango de datos."
  )
)

kable(metricas_general, format = "html", caption = "üìä M√©tricas Generales del Modelo de Regresi√≥n M√∫ltiple") %>%
  kable_styling(full_width = FALSE, bootstrap_options = c("striped", "hover", "condensed"))
```
üí°Nota: Es un modelo con buen poder explicativo y ajustado correctamente (sin sobreajuste aparente).


‚öôÔ∏è Tabla 2 ‚Äî Coeficientes Principales del Modelo
```{r tabla_coeficientes_interpretacion, results='asis'}
coeficientes_principales <- data.frame(
  Variable = c(
    "Intercepto",
    "Edad",
    "Minutos jugados",
    "Asistencias",
    "Posici√≥n CC_DL",
    "Posici√≥n DL",
    "Posici√≥n DL_CC"
  ),
  Estimaci√≥n = c("-1.76", "+0.03", "+0.0010", "+0.52", "+1.42", "+3.59", "+2.00"),
  Significancia = c("**", "ns", "***", "***", "**", "***", "***"),
  Interpretaci√≥n = c(
    "Valor base del modelo.",
    "Efecto leve y no significativo de la edad.",
    "Cada 1000 minutos adicionales se asocian con +1 gol aprox.",
    "Cada asistencia se relaciona con +0.52 goles adicionales.",
    "Mediocampistas ofensivos marcan m√°s goles que el grupo base.",
    "Delanteros puros anotan +3.6 goles promedio respecto al grupo base.",
    "Delanteros mixtos (DL_CC) tambi√©n tienen un rendimiento goleador elevado."
  )
)

kable(coeficientes_principales, format = "html", caption = "‚öôÔ∏è Coeficientes Principales e Interpretaci√≥n del Modelo") %>%
  kable_styling(full_width = FALSE, bootstrap_options = c("hover", "condensed", "responsive"))
```


üìà Tabla 3 ‚Äî Evaluaci√≥n del Modelo (Conjunto de Prueba)
```{r tabla_resultados_test, results='asis'}
evaluacion_test <- data.frame(
  M√©trica = c("Error Cuadr√°tico Medio (RMSE)", "R-cuadrado (R¬≤)", "Interpretaci√≥n General"),
  Valor = c("2.198", "0.516", ""),
  Interpretaci√≥n = c(
    "En promedio, el modelo se desv√≠a en unos 2.2 goles por jugador.",
    "El modelo explica el 51.6% de la variabilidad de los goles en el conjunto de prueba.",
    "El rendimiento es s√≥lido y consistente con el entrenamiento; el modelo generaliza bien y no est√° sobreajustado."
  )
)

kable(evaluacion_test, format = "html", caption = "üìà Evaluaci√≥n del Modelo en Conjunto de Prueba") %>%
  kable_styling(full_width = FALSE, bootstrap_options = c("striped", "hover", "condensed"))
```

üß† Tabla 4 ‚Äî Conclusi√≥n Interpretativa Final
```{r tabla_conclusion_modelo, results='asis'}
conclusion_modelo <- data.frame(
  Aspecto = c(
    "Predictores m√°s influyentes",
    "Variables sin efecto significativo",
    "Desempe√±o general",
    "Conclusi√≥n final"
  ),
  Resumen = c(
    "Los minutos jugados, las asistencias y las posiciones ofensivas (DL, DL_CC, CC_DL).",
    "La edad y las posiciones defensivas.",
    "El modelo explica aproximadamente el 50% de la variabilidad total en los goles con un error moderado.",
    "La productividad goleadora depende principalmente de la participaci√≥n activa en cancha y del rol t√°ctico ofensivo, m√°s que de la edad."
  )
)

kable(conclusion_modelo, format = "html", caption = "üß† Conclusi√≥n Interpretativa del Modelo de Regresi√≥n") %>%
  kable_styling(full_width = FALSE, bootstrap_options = c("striped", "hover", "condensed"))
```
üß© En Resumen:

- Los minutos jugados y las asistencias son los predictores m√°s s√≥lidos y estad√≠sticamente significativos.
- Las posiciones ofensivas (DL, DL_CC, CC_DL) son las que verdaderamente elevan la cantidad de goles esperada.
- La edad no resulta significativa, coherente con el EDA.
- El modelo predice razonablemente bien y explica casi la mitad de la variabilidad total en goles (R¬≤ ‚âà 0.48).

üß© Implicancia:
- Los minutos jugados, asistencias y posici√≥n ofensiva son las variables m√°s influyentes para explicar el n√∫mero de goles de un jugador en la liga espa√±ola.
- Mientras que la edad y posiciones defensivas no aportan un efecto significativo.
- Se confirma que la productividad goleadora depende m√°s de la participaci√≥n y el rol t√°ctico que de la edad del jugador.



## Transici√≥n entre Modelo de Regresi√≥n y ANOVA
- Luego de entrenar y evaluar el modelo de regresi√≥n y obtener m√©tricas de desempe√±o como el R-cuadrado y el RMSE, se complementa analizando c√≥mo var√≠an los goles seg√∫n la posici√≥n de los jugadores.
- La regresi√≥n permite cuantificar la relaci√≥n entre variables continuas y categ√≥ricas, pero un an√°lisis m√°s espec√≠fico sobre la diferencia promedio de goles entre posiciones requiere aplicar t√©cnicas de comparaci√≥n de medias. Se realiza el An√°lisis de Varianza (ANOVA) seguido de la prueba de comparaciones m√∫ltiples de Tukey.
- Se busca determinar si existen diferencias estad√≠sticamente significativas en la capacidad goleadora entre las distintas posiciones, al identificar qu√© posiciones concretas difieren entre s√≠, m√°s all√° de lo que el modelo de regresi√≥n pueda indicar.
- Se complementa la interpretaci√≥n del modelo con hallazgos m√°s intuitivos y visuales, para presentar resultados a p√∫blicos variados (entrenadores, analistas deportivos o aficionados).
- El ANOVA/Tukey se integra de forma natural dentro del flujo de an√°lisis, despu√©s de evaluar el modelo predictivo y antes de profundizar en conclusiones finales sobre el desempe√±o de los jugadores.


# üß© Paso 6 ‚Äî ANOVA y Comparaciones entre Posiciones (Integrado)
## Ajuste de ANOVA
```{r}
# ANOVA: Goles seg√∫n posici√≥n
anova_goles <- aov(goles ~ posicion, data = df)
summary(anova_goles)
```

## Comparaci√≥n m√∫ltiple Tukey
```{r}
# Comparaci√≥n m√∫ltiple entre todas las posiciones
tukey_goles <- TukeyHSD(anova_goles)

# Mostrar resultados
tukey_goles
```

## Gr√°fico de Tukey
```{r}
plot(tukey_goles, las=1, col="steelblue")
```
### Conlusiones ANOVA/Tukey:

#### ANOVA
- Valor F = 19 y p < 2e-16 ‚Üí Rechazamos H‚ÇÄ.
- Existe diferencias estad√≠sticamente significativa en goles promedio entre al menos dos posiciones.

#### Comparaciones de Tukey
- Posiciones con promedio de goles alto: DL (mediocampistas), DL_CC y CC_DL marcan m√°s que CC y otras posiciones ofensivas.
- Posiciones con promedio de goles bajo: PO (porteros), DL_DF y DL_CC_DF marcan significativamente menos.
- Las posiciones ofensivas e h√≠bridas muestran diferencias significativas frente a defensivas o porteros.

##### Conclusi√≥n final:
- La posici√≥n influye claramente en la capacidad goleadora.
- Es curioso que los mediocampistas (DL) presentan el promedio de goles m√°s alto en este dataset.
- Los roles mixtos (CC_DL, DL_CC) tambi√©n superan en promedio a defensas y porteros.


# üß† Paso 7 ‚Äî Evaluaci√≥n y diagn√≥stico Visual del Modelo de Regresi√≥n
## Introducci√≥n
Se realiza evaluaci√≥n visual de los resultados del modelo de regresi√≥n m√∫ltiple ajustado en el paso anterior.  
Se analizan tres gr√°ficos de diagn√≥stico cl√°sicos:  
(1) Ajuste del modelo, (2) Homocedasticidad y (3) Normalidad de los residuos.

### Nota: en caso de haber aplicado Restart R se recrea de nuevo el modelo antes de las gr√°ficas:
```{r asegurar_modelo, include=FALSE}
# ‚öôÔ∏è Asegurar que el modelo y los datos existen
if (!exists("train_data") | !exists("test_data")) {
  set.seed(123)
  train_index <- createDataPartition(df$goles, p = 0.8, list = FALSE)
  train_data <- df[train_index, ]
  test_data <- df[-train_index, ]
}

if (!exists("modelo")) {
  modelo <- lm(goles ~ edad + min + asistencias + posicion, data = train_data)
}
```
Para hacerlo 100% robusto (por si el entorno se limpia, o el profesor abre tu notebook desde cero), agreg√° esta celda de seguridad justo antes de tus gr√°ficas:

## üß† Gr√°ficas explicativas

#### 1Ô∏è‚É£ Gr√°fico de Valores Reales vs. Predichos
Para ver qu√© tan cerca est√°n las predicciones del modelo de los valores reales de goles. Una buena regresi√≥n debe indicar puntos alineados a la diagonal (l√≠nea roja).
```{r grafico_real_vs_predicho, fig.width=6, fig.height=5}
predicciones <- data.frame(
  Real = test_data$goles,
  Predicho = predict(modelo, newdata = test_data)
)

ggplot(predicciones, aes(x = Real, y = Predicho)) +
  geom_point(alpha = 0.7, color = "steelblue") +
  geom_abline(slope = 1, intercept = 0, color = "red", linetype = "dashed") +
  labs(
    title = "üéØ Valores Reales vs Predichos",
    subtitle = "Comparaci√≥n entre goles observados y estimados por el modelo",
    x = "Goles Reales",
    y = "Goles Predichos"
  ) +
  theme_minimal()
```

#### 2Ô∏è‚É£ Gr√°fico de **Residuos vs. Predicciones**
Para comprobar si los errores del modelo (residuos) son aleatorios.  
Si se observa una nube difusa sin patr√≥n claro, el modelo es consistente.  
Si se muestra una forma curva o cono, el modelo puede tener problemas de ajuste.

```{r grafico_residuos, fig.width=6, fig.height=5}
residuos <- resid(modelo)
predichos <- predict(modelo)

ggplot(data.frame(predichos, residuos), aes(x = predichos, y = residuos)) +
  geom_point(alpha = 0.6, color = "darkorange") +
  geom_hline(yintercept = 0, color = "red", linetype = "dashed") +
  labs(
    title = "üìâ Residuos vs Predicciones",
    subtitle = "Evaluaci√≥n de homocedasticidad del modelo",
    x = "Valores Predichos",
    y = "Residuos (Errores)"
  ) +
  theme_minimal()
```

#### 3Ô∏è‚É£ Histograma o **Gr√°fico QQ de Residuos**
Verifica si los errores del modelo se distribuyen normalmente (supuesto de regresi√≥n lineal).

```{r grafico_qqplot, fig.width=6, fig.height=5}
ggplot(data.frame(residuos), aes(sample = residuos)) +
  stat_qq(color = "royalblue") +
  stat_qq_line(color = "red", linetype = "dashed") +
  labs(
    title = "üìä QQ-Plot de Residuos",
    subtitle = "Comprobaci√≥n de normalidad de los residuos"
  ) +
  theme_minimal()
```

#### Diagn√≥stico
```{r diagnostico_visual_html, results='asis'}
library(kableExtra)

diagnostico_modelo <- data.frame(
  Gr√°fico = c(
    "üéØ Valores Reales vs. Predichos",
    "üìâ Residuos vs. Predicciones",
    "üìä QQ-Plot de Residuos"
  ),
  Supuesto = c(
    "Ajuste del Modelo (Linealidad)",
    "Homocedasticidad (Varianza constante de errores)",
    "Normalidad de los Residuos"
  ),
  Observaci√≥n_Principal = c(
    "Alta dispersi√≥n en valores bajos (0‚Äì5 goles) y subestimaci√≥n de goleadores con m√°s de 10 goles. El modelo predice hasta ~7.5 goles y no capta la magnitud de los jugadores de √©lite.",
    "Patr√≥n de cono invertido: los residuos se dispersan m√°s a medida que aumentan los valores predichos. La varianza del error no es constante.",
    "Los puntos se alinean en el centro, pero se desv√≠an en las colas. Cola derecha con outliers positivos (jugadores top subestimados)."
  ),
  Conclusi√≥n = c(
    "El modelo muestra un ajuste pobre en los extremos. No capta la asimetr√≠a de la variable dependiente. Ser√≠a recomendable aplicar una transformaci√≥n logar√≠tmica o usar un modelo de conteo (Poisson o Neg. Binomial).",
    "Se viola la homocedasticidad: los errores est√°ndar y p-valores pueden ser inestables. La varianza del error aumenta con el valor predicho.",
    "Se viola la normalidad: los residuos presentan cola derecha pesada. La presencia de outliers afecta la estimaci√≥n lineal tradicional."
  )
)

kable(diagnostico_modelo, format = "html",
      caption = "üß† Diagn√≥stico Visual del Modelo de Regresi√≥n M√∫ltiple") %>%
  kable_styling(full_width = FALSE,
                bootstrap_options = c("striped", "hover", "condensed", "responsive")) %>%
  column_spec(1, bold = TRUE) %>%
  column_spec(4, width = "25em")
```


üìù Resumen de diagn√≥stico interpretativo complementario

**Conclusi√≥n general del diagn√≥stico:**

El modelo lineal ajustado para predecir el n√∫mero de goles presenta tres debilidades estructurales:

1. **Ajuste insuficiente:** Tiende a subestimar de forma sistem√°tica los valores extremos (jugadores con muchos goles), lo que indica que el modelo lineal no es capaz de representar adecuadamente la relaci√≥n entre minutos/asistencias y goles.

2. **Heterocedasticidad:** La varianza del error aumenta conforme crecen los valores predichos. Esto invalida los supuestos de varianza constante necesarios para la inferencia lineal fiable.

3. **No normalidad:** Los residuos no siguen una distribuci√≥n normal debido a la existencia de outliers significativos (jugadores de rendimiento excepcional).

**Recomendaci√≥n metodol√≥gica:**
Dado que la variable dependiente ‚Äúgoles‚Äù es un **conteo discreto y asim√©trico**, el uso de una **regresi√≥n de Poisson** o **binomial negativa**, o incluso modelos **Zero-Inflated (ZIP o ZINB)**, ser√≠a m√°s adecuado.  
Estos modelos pueden manejar la abundancia de ceros y la dispersi√≥n observada, ofreciendo una estimaci√≥n m√°s realista del rendimiento goleador.


#### **Recomendaci√≥n metodol√≥gica:**

##### Modelado Avanzado: Regresi√≥n de Conteo (Zero-Inflated)
- El modelo de Regresi√≥n Lineal (RL) del Paso 5 fall√≥ los supuestos de normalidad y homocedasticidad (caracter√≠stica com√∫n en variables de conteo como "goles") y se determin√≥ que un modelo especializado es necesario.
- Se eval√∫an modelos Zero-Inflated Poisson (ZIP) y Zero-Inflated Negative Binomial (ZINB) del paquete pscl, ya que la variable "goles" presenta una alta inflaci√≥n de ceros (jugadores con 0 goles).
- Diagn√≥stico y simplificaci√≥n: En los primeros modelos ZINB existe un problema cr√≠tico de singularidad computacional (colinealidad extrema), que impide c√°lculo de errores est√°ndar de los coeficientes, por la alta redundancia de variables (Colinealidad entre min (minutos) y posicion que miden aspectos muy similares del rol del jugador)
- Exceso de categor√≠as en posicion, la alta granularidad de categor√≠as h√≠bridas (DF_DL) causa separaci√≥n de datos e incurre as√≠ en la singularidad.

**Se simplifica de dos maneras sucesivas:**
- Eliminar variable min (minutos jugados).
- Crear nueva variable posicion_simple y agrupar las posiciones h√≠bridas en categor√≠as robustas: Ataque, Medio, Defensa, y Portero.

**Modelo Final y Resultados**
A continuaci√≥n, se presenta el modelo Zero-Inflated Negative Binomial (ZINB) final. Para atender la problem√°tica de diagn√≥stico de la RL y la sobredispersi√≥n inherente a los datos de conteo. Incluye las variables: edad, asistencias y la variable categ√≥rica simplificada posicion_simple para predecir la tasa de goles y la probabilidad de registrar cero goles.


**1. A√±adir la Columna Simplificada**
```{r}
### Chunk: Simplificaci√≥n de la Posici√≥n
library(dplyr)

# Sobrescribe el data frame modelo_df a√±adiendo la columna posicion_simple
modelo_df <- modelo_df %>%
  mutate(posicion_simple = case_when(
    # Delanteros y ofensivos puros (DL, CC_DL)
    grepl("DL|CC_DL", posicion) ~ "Ataque", 
    # Centrocampistas puros (CC, CC_DF)
    grepl("CC", posicion) & !grepl("DL|DF", posicion) ~ "Medio",
    # Defensas y mediocentros defensivos (DF, DF_CC)
    grepl("DF", posicion) & !grepl("DL", posicion) ~ "Defensa",
    # Porteros
    grepl("PO", posicion) ~ "Portero",
    # Posiciones no especificadas que existan (para cubrir cualquier caso)
    TRUE ~ "Otros"
  ))

# Variable de tipo factor para el modelo
modelo_df$posicion_simple <- as.factor(modelo_df$posicion_simple)
```

**2. Ejecutar el Modelo ZINB Final**
```{r}
## Chunk: Modelo ZINB Final
zinb_model_final <- zeroinfl(goles ~ edad + asistencias + posicion_simple | posicion_simple,
                             data = modelo_df, dist = "negbin")
summary(zinb_model_final)
```
**Conclusiones finales del modelo**
```{r}
# Tabla ZINB
# Obtener el resumen del modelo
summary_zinb <- summary(zinb_model_final)

# --- 1. Extraer y formatear el Modelo de Conteo (Count Model) ---
conteo_raw <- as.data.frame(summary_zinb$coefficients$count)
# Asignar los nombres de fila como una columna del data frame.
conteo_df <- conteo_raw %>%
  # Asignamos la columna 'Termino' antes de entrar a la tuber√≠a
  mutate(Termino = rownames(conteo_raw)) %>%
  # Limpieza y c√°lculos
  mutate(
    Componente = "Tasa de Goles (Conteo)",
    Termino = case_when(
      Termino == "(Intercept)" ~ "L√≠nea Base: Atacante",
      Termino == "edad" ~ "Edad (a√±os)",
      Termino == "asistencias" ~ "Asistencias",
      Termino == "posicion_simpleDefensa" ~ "Posici√≥n: Defensa",
      Termino == "posicion_simpleMedio" ~ "Posici√≥n: Medio",
      Termino == "posicion_simplePortero" ~ "Posici√≥n: Portero",
      Termino == "Log(theta)" ~ "Log(theta) (Dispersion)",
      TRUE ~ Termino
    ),
    Effect_Ratio = exp(Estimate),
    Significancia = case_when(
      `Pr(>|z|)` < 0.001 ~ "***",
      `Pr(>|z|)` < 0.01 ~ "**",
      `Pr(>|z|)` < 0.05 ~ "*",
      `Pr(>|z|)` < 0.1 ~ ".",
      TRUE ~ ""
    )
  ) %>%
  dplyr::select(Componente, Termino, Estimate, Std.Error = `Std. Error`, Z_Value = `z value`, P_Value = `Pr(>|z|)`, Effect_Ratio, Significancia)

# --- 2. Extraer y formatear el Modelo de Ceros (Zero-Inflation Model) ---
ceros_raw <- as.data.frame(summary_zinb$coefficients$zero)
ceros_df <- ceros_raw %>%
  # Asignamos la columna 'Termino' antes de entrar a la tuber√≠a
  mutate(Termino = rownames(ceros_raw)) %>%
  # Limpieza y c√°lculos
  mutate(
    Componente = "Probabilidad de Cero Extra",
    Termino = case_when(
      Termino == "(Intercept)" ~ "L√≠nea Base: Atacante",
      Termino == "posicion_simpleDefensa" ~ "Posici√≥n: Defensa",
      Termino == "posicion_simpleMedio" ~ "Posici√≥n: Medio",
      Termino == "posicion_simplePortero" ~ "Posici√≥n: Portero",
      TRUE ~ Termino
    ),
    Effect_Ratio = NA_real_,
    Significancia = case_when(
      `Pr(>|z|)` < 0.001 ~ "***",
      `Pr(>|z|)` < 0.01 ~ "**",
      `Pr(>|z|)` < 0.05 ~ "*",
      `Pr(>|z|)` < 0.1 ~ ".",
      TRUE ~ ""
    )
  ) %>%
  dplyr::select(Componente, Termino, Estimate, Std.Error = `Std. Error`, Z_Value = `z value`, P_Value = `Pr(>|z|)`, Effect_Ratio, Significancia)

# --- 3. Unir y generar la tabla final con kableExtra ---
final_df <- bind_rows(conteo_df, ceros_df) %>%
  mutate(across(where(is.numeric), ~round(.x, 3)))

final_df %>%
  kable(
    caption = "Resultados del Modelo Zero-Inflated Negative Binomial (ZINB) Final",
    format = "html",
    align = 'lrrrrrr',
    col.names = c("Componente", "T√©rmino", "Estimaci√≥n", "Error Est.", "Valor Z", "Valor P", "Efecto Ratio (e^Est.)", "Sig.")
  ) %>%
  kable_styling(
    bootstrap_options = c("striped", "hover", "condensed", "responsive"),
    full_width = FALSE,
    position = "left"
  ) %>%
  pack_rows(
    index = c(
      "Modelo de Conteo (Tasa de Goles)" = nrow(conteo_df),
      "Modelo de Inflaci√≥n de Ceros" = nrow(ceros_df)
    )
  )
```

**üèÅ Hallazgos del an√°lisis exploratorio, la regresi√≥n y el diagn√≥stico, culminando en el modelo de conteo m√°s robusto: el Zero-Inflated Negative Binomial (ZINB).:**

**1. Justificaci√≥n del Modelo ZINB**
- Inflaci√≥n de Ceros: La distribuci√≥n de la variable Goles muestra alta concentraci√≥n de valores en cero, lo que confirma la necesidad de un modelo Zero-Inflated.
- Sobredispersi√≥n: El par√°metro Log(0)=0.126 (implica approx 1.134) es positivo en el modelo ZINB indicando sobredispersi√≥n (mayor varianza que la media) y justificando el uso de la distribuci√≥n Negative Binomial sobre la Poisson.
- Modelo V√°lido: La simplificaci√≥n de la variable Posicion a posicion_simple resolvi√≥ la singularidad computacional, produciendo errores est√°ndar y valores p v√°lidos en el modelo de conteo.

**2. Interpretaci√≥n del Modelo de Conteo (Tasa Esperada de Goles):** Predice la tasa esperada de goles para un jugador que se espera que anote (excluyendo los "ceros extra"). Todos los coeficientes son altamente significativos (p << 0.05) con excepci√≥n del intercepto (L√≠nea Base: Atacante) que es marginalmente significativo.

  - A. Factores Positivos (Aumento de Goles): 
    - Asistencias es el factor m√°s influyente. Por cada asistencia adicional, la tasa esperada de goles de un jugador aumenta aproximadamente en un 27.1% (Effect Ratio = 1.271, p < 0.001). Fuerte relaci√≥n entre la capacidad de generar jugadas (asistencias) y la de finalizar (goles).
    - La edad tiene un efecto positivo. Por cada a√±o adicional de edad, la tasa esperada de goles aumenta aproximadamente en un 5.0% (Effect Ratio = 1.050, p < 0.001). Sugiere que en la muestra, los jugadores m√°s veteranos tienden a tener una tasa de goles m√°s alta (experiencia o roles ofensivos clave).

  - B. Factores de Posici√≥n (Disminuci√≥n de Goles):
    - La posici√≥n es el principal factor de predicci√≥n, usando Atacante (Ataque) como l√≠nea base.

```{r}
# Crear el data frame con la informaci√≥n espec√≠fica de la imagen
tabla_efecto_ratio_posiciones <- data.frame(
  Posicion = c("Mediocampista", "Defensa", "Portero"),
  Efecto_Ratio = c(0.289, 0.232, 0.023),
  Interpretacion = c(
    "La tasa esperada de goles es 71.1% menor (1 - 0.289) que la de un atacante.",
    "La tasa esperada de goles es 76.8% menor (1 - 0.232) que la de un atacante.",
    "La tasa esperada de goles es pr√°cticamente nula, siendo 97.7% menor que la de un atacante."
  )
)

# Generar la tabla con kableExtra
tabla_efecto_ratio_posiciones %>%
  kable(
    caption = "Factores de Posici√≥n: Disminuci√≥n en la Tasa Esperada de Goles (Modelo ZINB)",
    format = "html",
    align = 'lcc', # Alinear la primera columna a la izquierda y las dem√°s al centro
    col.names = c("Posici√≥n", "Efecto Ratio (vs. Atacante)", "Interpretaci√≥n")
  ) %>%
  kable_styling(
    bootstrap_options = c("striped", "hover", "condensed", "responsive"),
    full_width = FALSE,
    position = "left"
  )
```
**3. Interpretaci√≥n del Modelo de Inflaci√≥n de Ceros (Probabilidad de No Marcar)**: 
- El Modelo de Ceros intenta explicar la probabilidad de que un jugador obtenga cero goles debido a un factor estructural (un "cero extra"), m√°s all√° de lo que predice su baja tasa de goles.

  - No Significativo: Todos los coeficientes en el Modelo de ceros son no significativos (valores p cercanos a 1.000).
  - Implicaci√≥n: Sugiere que la baja tasa esperada de goles para los Defensas, Mediocampistas y Porteros, como se predice en el Modelo de Conteo, ya es suficiente para explicar la alta cantidad de ceros. No se necesita un mecanismo "extra" de cero para estas posiciones, ya que su bajo promedio de goles de por s√≠ predice una alta probabilidad de cero.

  - Variables de  impacto significativo en el n√∫mero de goles de un jugador
    - Asistencias
    - Edad
    - Posici√≥n del jugador.

  - Relaci√≥n entre posiciones con el n√∫mero de goles
    - Diferencia jer√°rquica clara: Posici√≥n de "Ataque" tiene la tasa de goles m√°s alta. Tasa de goles de los Mediocampistas, Defensas y Porteros es significativamente menor (71% a 97% menos, respectivamente) que la de los Atacantes. (intuitivo y coherente con el an√°lisis exploratorio).

  - Factor de "experiencia" / Edad influye en los goles
    - La edad est√° asociada positivamente con una tasa de goles un 5% mayor por a√±o.



# ‚úÖ Paso 8: Interpretaci√≥n integral y conclusiones finales
## Objetivo: Integrar resultados del EDA, ANOVA/Tukey y el Modelo ZINB

### 1. Interpretaci√≥n Clave del Modelo ZINB (Efecto de la Posici√≥n)
Esta tabla resume c√≥mo las diferentes posiciones impactan la tasa esperada de goles, tomando la categor√≠a "Ataque" como l√≠nea base

| Posici√≥n | Efecto Ratio (vs. Atacante) | Interpretaci√≥n |
| :--- | :--- | :--- |
| Mediocampista | 0.289 | La tasa esperada de goles es **71.1% menor** (1‚àí0.289) que la de un atacante. |
| Defensa | 0.232 | La tasa esperada de goles es **76.8% menor** (1‚àí0.232) que la de un atacante. |
| Portero | 0.023 | La tasa esperada de goles es pr√°cticamente nula, siendo **97.7% menor** que la de un atacante. |

---

### 2. Resumen de Hallazgos Metodol√≥gicos Clave
```{r resumen_hallazgos_final_zinb, results='asis'}
# 1. Definir m√©tricas del Modelo Final ZINB
# El modelo ZINB es el resultado final, por lo que reemplazamos las m√©tricas de la Regresi√≥n Lineal fallida (RMSE, R2).
# Estas funciones se ejecutan sobre el objeto 'zinb_model_final' creado en el Paso 7.
aic_val <- round(AIC(zinb_model_final), 3)
loglik_val <- round(logLik(zinb_model_final), 3)

# 2. Crear la tabla integrada de hallazgos, reemplazando la fila "Regresi√≥n" por "Modelo ZINB"
hallazgos_final <- data.frame(
  Analisis = c("Exploratorio","Modelo ZINB","ANOVA","Tukey"),
  Hallazgos = c(
    "Distribuci√≥n con alta inflaci√≥n de ceros y sobredispersi√≥n (necesidad ZINB).",
    paste0("LogLik = ", loglik_val, ", AIC = ", aic_val, ". Modelo v√°lido y robusto para datos de conteo."),
    "Diferencias significativas en goles promedio entre posiciones (F=19, p<2e-16).",
    "DL > CC y roles h√≠bridos ofensivos (CC_DL, DL_CC) son consistentemente superiores."
  )
)

# 3. Generar la tabla HTML
library(knitr)
library(kableExtra)

hallazgos_final %>%
  kable(caption = "Resumen de Hallazgos Clave") %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed"))
```

### 3. Conclusiones y discusi√≥n final
- A. Transici√≥n al Modelo ZINBE
  - An√°lisis Exploratorio y el ANOVA/Tukey establen que la "Posici√≥n" es un predictor clave de los goles.
    - Pero el diagn√≥stico del Modelo de Regresi√≥n Lineal (Paso 7) revel√≥ fallos cr√≠ticos (heterocedasticidad y no normalidad)
    - Requiri√≥ adoptar el Modelo ZINB para variables de conteo discreto con inflaci√≥n de ceros como los goles.
    
- B. Hallazgos del Modelo ZINB:
  - Factores Positivos:
    - Asistencias: Factor m√°s influyente. Por cada asistencia, la tasa esperada de goles aumenta aprox. en 27.1% (Effect Ratio=1.271), fuerte conexi√≥n entre creaci√≥n y finalizaci√≥n.
    - Edad: Por cada a√±o adicional de edad la tasa esperada de goles aumenta aprox. un 5.0%. Sugiere que la experiencia o roles clave en el equipo son importantes.
    
  - Factor Dominante (Posici√≥n): 
    - An√°lisis confirma y cuantifica la jerarqu√≠a de goles: La tasa de goles de Mediocampistas, Defensas y Porteros es significativamente menor (entre 71% y 97% menos, respectivamente) que la de los Atacantes.
  
  - Inflaci√≥n de Ceros: El Modelo de Ceros no encontr√≥ variables significativas. Implica que la baja tasa esperada de goles para roles defensivos es suficiente para explicar la abundancia de jugadores con 0 goles.
    
- C. Integraci√≥n y Estrategia:
  - Liderazgo Ofensivo: Mediocampistas (DL) y roles h√≠bridos ofensivos (CC_DL, DL_CC) lideran el promedio de goles (confirmado por Tukey) y demuestran importancia de la flexibilidad t√°ctica en el gol.
  
  - Predicci√≥n y Rol: La posici√≥n de juego es el factor m√°s determinante. El ZINB permite no solo identificar las diferencias (ANOVA) sino cuantificar el impacto (Efecto Ratio) de cada rol en la capacidad goleadora, esencial para el dise√±o de estrategias.
  
- Conclusi√≥n Final Destacada:
  - La posici√≥n de juego es un factor determinante en la capacidad goleadora.
  - Mediocampistas (DL) y roles h√≠bridos ofensivos lideran promedio de goles, incluso m√°s que los delanteros puros
  - El Modelo ZINB es el enfoque estad√≠stico m√°s robusto para predecir goles, confirmando que la productividad goleadora depende de un rol t√°ctico ofensivo, asistencias y experiencia.